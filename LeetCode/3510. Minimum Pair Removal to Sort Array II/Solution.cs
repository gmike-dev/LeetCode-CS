using LeetCode.Common;

namespace LeetCode._3510._Minimum_Pair_Removal_to_Sort_Array_II;

public class Solution
{
  public int MinimumPairRemoval(int[] nums)
  {
    var n = nums.Length;
    Span<long> value = stackalloc long[n];
    Span<int> next = stackalloc int[n];
    Span<int> prev = stackalloc int[n];
    Span<int> versions = stackalloc int[n];
    var queue = new PriorityQueue<(int index, int version), (long sum, int index)>();
    var inversions = 0;
    for (var i = 0; i < n; i++)
    {
      value[i] = nums[i];
      prev[i] = i - 1;
      next[i] = i + 1;
      if (i > 0)
      {
        queue.Enqueue((i - 1, 0), (value[i - 1] + value[i], i - 1));
        if (value[i - 1] > value[i])
          inversions++;
      }
    }
    var result = 0;
    while (inversions > 0)
    {
      var (node, version) = queue.Dequeue();
      if (versions[node] == -1 || versions[node] != version)
      {
        continue;
      }
      if (value[node] > value[next[node]])
      {
        inversions--;
      }
      if (next[next[node]] != n && value[next[node]] > value[next[next[node]]])
      {
        inversions--;
      }
      if (prev[node] != -1 && value[prev[node]] > value[node])
      {
        inversions--;
      }

      value[node] += value[next[node]];
      versions[next[node]] = -1;
      next[node] = next[next[node]];
      if (next[node] != n)
      {
        prev[next[node]] = node;
      }

      if (next[node] != n)
      {
        versions[node]++;
        queue.Enqueue((node, versions[node]), (value[node] + value[next[node]], node));
      }
      if (prev[node] != -1)
      {
        versions[prev[node]]++;
        queue.Enqueue((prev[node], versions[prev[node]]), (value[prev[node]] + value[node], prev[node]));
      }
      result++;

      if (prev[node] != -1 && value[prev[node]] > value[node])
      {
        inversions++;
      }
      if (next[node] != n && value[node] > value[next[node]])
      {
        inversions++;
      }
    }
    return result;
  }
}

[TestFixture]
public class SolutionTests
{
  [TestCase("[5,2,3,1]", 2)]
  [TestCase("[1,2,2]", 0)]
  [TestCase("[1]", 0)]
  [TestCase("[1, -1]", 1)]
  [TestCase("[2,2,-1,3,-2,2,1,1,1,0,-1]", 9)]
  [TestCase("[-85529083,50623755,137256618,-61570376,-126713871,28826144,-16719957,-105112342,129065525,103867114,-26922265,-131506900,-95911412,-47467004,-14997164,-127582145,-134804061,33310540,142798940,-13145840,65166170,35068653,18595615,-132201277,25180671,144004972,-129552715,-3344878,73634657,-79910753,-19236130,99402308,7743344,-86821450,119281472,-6068119,81243915,-102846134,-96211242,-40700764,61343170,55808619,-117988802,38226108,-143241943,-131844717,-3176334,1949193,138201727,87533333,-29245467,-47737669,-129572839,-113624184,63102760,109509982,26289482,-36690573,5179672,20046003,-1931819,-92066426,115806233,-43978252,-35018552,98729017,-7624702,-144395150,-63853205,51050102,-55212280,-95646785,41889766,-117036314,-115107912,67156211,-42583779,75176751,-65622385,-21674094,91983598,91832589,66890439,-71815689,133219798,52920160,42945411,-116325290,115565827,118588545,23909767,39558897,-114532846,91304111,-101519640,4674156,28826194,-43443706,81718209,-3400726,6714297,80951282,-132070257,140901812,-20333337,-108918823,46606967,110512652,-21634460,-82025702,41372932,-84218845,-62741015,-52234402,124578366,-28252652,110078650,113550788,101825470,15946063,135042613,-78037718,48655417,-35739568,4696071,117224658,132781377,42641053,-38961442,92279700,-118793824,63525502,47634544,8477718,30391775,-135937793,104765233,93453925,-130922374,-127323012,10761157,92824837,111566892,26794662,77030700,-31102364,83066241,131109967,2422623,76185512,55907931,-87390549,-123240792,67173778,-137794748,-106524498,136373171,20243314,-114768495,133751614,18386218,127578482,21372637,139926658,116153651,31269839,21299894,-132904148,-19440315,76704010,-76752615,-17595611,98587335,-16884259,-55298770,85161966,-22817391,41923630,124915890,14371783,-23640168,33695877,44641461,-140445978,-141898117,24648653,-7653128,50727563,67658018,-116321273,60538195,113761456,-140599962,69464759,-53912949,126830164,98375650,55663908,-5679411,-10129308,82657297,-69939062,-94534507,-4260696,-36174843,-17832515,-65519716,100564624,1048242,124749241,-115719961,-116358476,130154990,-125982265,-77854899,-25477289,-97827290,33557892,-82813819,-41593654,-10239959,-79434173,7316102,103929866,-61290435,11154820,91371707,135673773,140036949,14582157,143510312,138028854,-23583427,-43807034,-72791445,138004727,86227582,131626127,-10865565,121424049,59818709,74911091,80930170,72812698,124045476,30058336,121742111,-26481433,98459112,-140869759,99226833,-3983006,142468270,-72201794,82515172,-9007858,114541461,61560614,69105969,-54497878,-85467796,82352124,-101292276,-112457210,-57176128,100155771,-47692029,-116908283,118435370,-66553332,63565770,-125630247,-60907449,-101920317,95570162,-105922593,-55827535,75003912,-13080123,-137564947,106545963,24344594,-40245335,-140624134,25339703,54210225,31993064,-16833211,-41040130,108957699,-46518716,118442108,67228301,48967180,-7178076,-79513587,-98427583,-23878398,-34584836,9185719,43032055,-129932354,9216391,137764679,-92388083,-102238613,-21612280,-83270757,124347185,-2445023,-127793591,-29578162,58781834,141627088,-47014874,-135502385,133019674,101361757,-50454714,-62681594,-2467899,105192876,-128051374,-49488675,50533648,-119151660,39911795,51203007,20751313,-70085710,-18828646,-1396218,-61301330,35482151,93909846,-18465883,-63615559,81448059,-130193528,-123478870,114279135,-13566817,84127155,72921321,-23389659,-99965725,-70375668,-95044592,-107181250,27224491,61829314,76739737,-128076697,-47097016,114181948,41365044,66519042,-63985171,-57463865,-49644826,-138515113,42222033,-70115557,24628632,127553392,94836363,-60966228,59249536,-2124856,5594572,-12916940,-42138366,-34827090,43394770,60979021,23742668,-60353108,78883238,6241787,-111467752,51731393,-63040860,6217067,52954921,-7819205,8572100,49455425,35437977,81630380,-27431672,59817959,-13108694,70622951,126333035,-90232943,-108578736,-57594042,125542865,-112775787,141527706,-30037993,-94327987,110277765,72676691,-19174747,-30382172,19028510,-52321987,21629697,-51097636,-805599,-87068163,-86376665,41690026,-31951145,127867379,61865793,-2716880,-49980279,-122186093,-31161407,-22618368,59981822,73095419,55071415,-61438139,-75935827,-63575648,109597957,17914138,141272971,-87031623,-70485163,-46903680,-138440851,109633453,137723066,56532202,-47286550,-89693887,80612748,-126853749,36071215,-70710991,-141901128,115186553,-14369229,74545464,22673668,9259356,97699138,-110079586,50008834,20079708,-72471153,-115683931,45606427,-119371855,-64043976,44483247,-46227234,-26538626,-96346760,-65141857,-130724366,28717790,5594391,131786724,78458613,130291470,-73417424,81064167,106005527,56035468,-16706644,34464747,114414092,-67042626,118896321,2943124,48902379,108509179,-33195225,102343293,76601929,-84635224,21003440,-89716602,50714689,-110304031,-7649750,-63866622,93013483,43834718,-66034973,-22676298,-25818352,121894736,-131288475,99055409,-54699411,-12135309,50722610,60526155,9308263,105945851,52537230,61079080,-94636620,-116710945,10541878,50102985,-69099803,-90773579,27573436,58115337,-134316135,85186940,-116710784,-139329182,-124567813,-61307924,-92044903,-64116753,15321297,-92144643,-103436343,-137765325,16992107,97652087,-71356363,-130248542,75082592,68220754,-141952723,-93374598,-23070191,-123507397,109268341,-8065863,-80966660,-10384014,-91098389,48214731,49430997,-6361543,-56658491,61321169,7958907,129045927,-139225578,-45236897,128062554,-69621749,-18793347,-38666912,101065682,89333753,-73718360,-201570,-12582244,1284171,27413183,-5572238,-116785390,14328658,98257765,47692891,29267438,-139677826,19662854,107414503,39112279,-135172922,-117697971,20628642,-78469738,-52788009,37258808,-75134715,-137679943,-106608254,81649063,74882950,-137845694,-60586373,-140245302,113476666,39598806,-24171678,-128535790,-140530935,111432889,-48359050,12718682,-47413510,129837567,-58414515,-95662927]", 598)]
  [TestCase("[-6,623,-430,116,-145,29,-507,-384,176,-614,-325,213,-680,-454,-611,-474,-586,299,-24,475,681,276,219,-5,-137,-294,-418,-683,642,-286,-552,-554,-147,690,66,203,-600,-99,-69,-355,-373,197,26,-587,-262,-452,-602,-546,697,-380,-675,-404,-186,-687,-583,530,58,-365,-338,-206,-436,425,247,684,212,-532,702,135,-628,-572,219,417,262,-260,170,-82,-439,146,490,-343,350,273,-653,373,106,-248,-107,-389,430,55,234,-52,-640,-544,-497,209,-246,141,-568,616,563,-622,364,-50,681,-224,-386,108,367,-490,-330,320,215,301,699,-699,458,-670,-688,-688,-411,427,-297,-141,394,24,-219,-231,405,-591,421,641,-576,669,-274,391,163,-511,-335,687,-616,80,-440,116,-688,369,277,-366,-426,375,114,495,483,-549,-600,-424,644,-371,-677,170,241,-5,-671,-341,-107,520,235,689,645,-164,548,-67,25,205,-588,-379,-464,77,599,145,333,-634,-549,213,-610,135,603,436,-333,-495,-373,675,412,-132,578,-314,-306,483,432,40,-581,657,5,-191,-152,-246,-140,-379,139,242,98,-6,359,-635,-115,296,406,464,-485,663,-614,152,53,-74,-86,632,251,407,74,117,-657,391,-518,-14,-59,294,289,-586,562,87,-581,373,467,-333,-419,-246,-144,-640,-50,294,-564,-136,-140,-186,-658,523,545,-426,473,-490,394,674,411,-191,571,512,-29,616,381,287,-233,66,266,-500,-280,437,-175,445,486,580,476,452,-435,357,-143,134,-242,45,-300,212,-543,-690,121,345,-271,-671,-430,201,-574,234,331,678,-621,-469,424,449,404,-427,-624,-346,406,-60,-382,542,475,-136,42,-58,604,-358,484,276,-380,-171,-90,-300,-184,-520,167,-81,29,426,482,-235,433,-640,194,-513,14,-408,527,-286,384,-631,626,-458,579,-271,230,-480,-65,465,201,685,144,-188,-633,678,350,633,-538,-483,-200,-195,307,81,-29,-413,523,-579,54,-360,395,438,-277,-370,-74,-29,658,613,-200,163,254,256,128,383,334,559,179,-547,-589,-631,193,67,461,-84,635,29,429,-46,-351,-144,-411,445,233,485,574,32,-569,94,-283,627,-649,99,194,-259,-565,-494,-63,701,-193,-85,252,-188,-572,535,550,-84,107,550,499,-96,663,213,223,-124,671,454,-623,212,529,-172,-550,-361,-356,-352,-345,-576,563,492,-348,697,-500,644,-100,-398,583,-401,-665,-487,262,142,190,-481,418,-258,165,199,-662,107,-486,239,-39,-112,-312,-338,650,-203,-97,-630,-249,-74,-125,-457,295,371,-563,-473,-295,-260,-600,-358,641,378,600,78,659,625,-457,30,686,96,223,-552,280,-651,327,-56,-536,-139,-140,-348,-231,-569,-178,-184,-284,367,-245,-455,-633,197,304,693,-467,-163,-154,608,402,-660,38,513,-304,-625,329,-587,-327,277,-558,-464,95,-702,-409,-466,-232,-588,668,-547,-674,-490,-281,36,-61,-506,11,668,-139,252,409,-498,-7,28,-637,-43,-419,436,-116,70,468,237,-615,213,121,-141,312,-643,-629,286,-463,228,-580,478,438,-229,-181,-385,-371,223,203,-172,398,-484,-41,-412,-428,652,670,272,10,-91,299,121,-225,-486,447,-594,-193,693,-688,-286,543,317,251,-562,-409,-273,-608,-205,-658,-174,-542,700,332,-62,-28,252,239,71,-578,-614,-22,15,-546,208,-439,451,55,-514,-40,-428,464,188,-284,30,-462,8,72,-470,-656,217,-62,29,455,-122,-601,134,526,-220,444,-92,361,10,375,696,-69,-619,479,506,-280,-639,596,478,165,117,-327,678,-683,-186,394,302,-554,428,-432,-337,-451,345,571,361,-628,-599,-31,-613,145,-606,-280,-625,90,-358,583,406,280,63,520,282,319,-678,216,374,-173,582,678,350,-124,570,-472,92,-250,496,394,153,-354,593,-217,526,400,-551,281,-411,-89,694,-206,-281,-448,698,-31,-228,-1,-505,-241,-401,562,599,511,-300,-41,691,-500,270,118,-603,-27,-513,-460,496,-103,248,587,157,-181,385,406,-379,-657,27,-382,226,436,-58,110,232,-44,193,667,-244,-34,417,193,14,438,545,605,61,-113,608,-49,97,-240,-243,-462,-546,204,686,-644,207,-410,-8,642,596,-431,197,70,-402,-204,566,-94,332,507,-87,179,686,382,-509,618,515,120,-73,471,664,561,-569,379,-118,-197,-186,435,313,223,225,-354,668,-441,-26,476,-256,577,245,-695,-637,-275,577,-232,91,-376,-485,6,-491,693,300,475,-123,-220,68,-691,624,-500,-597,-54,-133,279,232,654,-384,543,-10,41,-369,-164,12,652,299,219,-16,336,-270,490,222,-327,525,-201,-652,87,639,701,21,92,-189,-21,-341,426,429,-331,373,-421,-602,109,-511,-37,-69,109,400,304,-510,115,548,483,698,-130,270,-701,-56,566,358,-354,331,-455,-417,-72,-692,-426,109,-150,68,224,-323,319,150,366,-121,400,109,560,473,642,313,-26,309,2,-512,-432,-425,530,175,241,130,277,210,-462,-530,-614,-289,-240,-575,402,593,653,693,188,566,286,-540,652,-61,-166,-518,-310,-368,-77,186,-58,542,25,-546,552,40,-513,15,494,370,-250,692,381,658,-337,-196,-596,89,-360,211,-503,-549,-529,670,558,394,631,601,262,104,-131,-224,199,-643,674,461,578,60,299,491,-466,643,-619,-92,-326,0,-259,-593,-519,667,48,106,-317,509,-156,261,-262,87,-548,685,-501,-188,-47,189,-620,-688,-447,-272,-238,-663,527,227,-423,194,-662,-253,415,-321,-235,-468,-542,-560,668,391,99,664,596,340,215,-224,49,610,-405,407,545,-333,-518,422,-286,247,417,-392,687,-162,-360,243,-229,-325,305,-54,-446,555,-316,-537,406,471,-70,-4,671,528,128,298,534,-561,353,-522,240,-447,322,-614,28,692,502,-511,251,363,170,582,624,73,-23,456,492,198,-103,216,368,97,74,342,599,576,-138,518,-398,-39,638,339,47,329,-566,-33,-244,151,70,376,-246,339,-461,-209,322,29,322,271,250,494,-409,274,429,659,132,653,-625,415,-401,702,546,572,-282,-489,-475,229,-655,418,0,-369,-255,554,-177,397,-454,-124,510,-264,-694,-329,-405,291,607,645,-195,184,111,-232,-671,-40,-143,397,-634,103,-332,436,-84,-163,-681,501,-226,-130,-629,-231,-62,490,607,164,87,502,-477,-59,88,-502,-465,-483,188,-594,574,-411,654,-612,209,502,671,12,346,-353,-331,124,333,-171,-133,-485,431,-123,-550,-186,-139,-515,277,42,-309,-242,-335,499,-103,99,-456,100,580,-116,449,-200,1,564,-78,-192,-276,-491,-54,-602,-208,596,-605,-259,-333,-161,-487,434,688,-537,-448,-131,-102,-638,-437,500,-552,66,-99,-630,-551,-10,272,-58,120,46,-473,-402,407,271,0,694,120,59,385,449,-38,501,357,32,-183,686,-636,-259,-413,32,-651,-213,-519,-632,-130,443,223,187,68,-531,-234,-126,529,561,-572,-631,416,-290,-279,213,333,239,-42,186,-454,-563,-184,288,-698,218,-533,-496,284,-656,-52,-395,431,-344,-191,69,359,249,139,91,-507,392,-659,418,-262,-227,-339,-622,-265,-374,-505,77,-90,-259,70,-637,654,-220,-139,15,190,-133,686,-678,691,35,454,-401,-60,393,-546,209,623,-368,-37,198,60,-617,497,283,175,372,-359,636,-675,244,-678,-174,-539,692,168,564,327,450,579,488,-610,270,-574,326,100,41,-367,-183,-290,-623,-553,26,-456,-667,289,-557,80,-309,-383,463,427,-542,276,501,-189,615,485,602,-89,362,-554,-574,172,235,-525,-471,-640,-493,-205,78,551,176,-303,499,-7,515,-115,-119,-673,-135,137,-595,211,-164,-121,-612,-285,-528,-460,-336,-646,-330,-197,682,146,453,99,105,297,294,-80,170,649,515,-539,-219,153,-243,-547,182,-24,214,299,-143,638,-566,-1,513,413,-11,310,334,378,666,318,-443,-639,185,206,213,-338,410,191,664,-342,596,277,-184,641,-6,206,-3,668,199,-639,-195,551,-93,165,-24,696,322,701,-118,503,68,680,272,532,-698,-359,253,-532,-297,632,-587,24,188,-76,83,-404,481,396,251,-173,102,181,246,670,260,612,433,-92,626,-213,-206,473,-15,447,-678,-187,-516,70,593,65,683,190,686,355,596,-507,240,-34,-644,577,179,600,-199,265,381,279,-669,532,-135,-346,-696,281,-587,64,-698,208,-422,-90,-538,199,-500,-94,-266,-447,-660,-280,246,473,-379,-2,287,-629,-631,-520,317,-378,-527,428,-16,523,288,448,359,207,186,-644,-328,-201,26,-581,662,655,-514,599,-487,273,432,551,274,-461,-640,154,-219,-498,-91,-25,-671,85,553,57,343,-102,-579,-480,-225,413,-155,177,-475,-248,-54,644,633,492,-76,220,330,493,449,107,338,-701,233,284,403,-253,463,-386,646,-506,-180,-412,638,697,54,-207,548,-551,418,192,-446,107,-603,247,-85,-637,619,-219,-70,-578,535,80,-379,-251,639,50,-483,-240,48,5,-352,-120,295,542,297,-117,-383,-452,555,-131,610,-634,-574,512,31,174,319,481,82,100,-439,-466,-632,195,455,633,-317,-593,-505,-406,-576,-658,-296,58,-310,529,503,179,-382,-592,-664,-84,116,84,296,415,-564,346,-366,201,75,-693,32,196,-694,-390,345,-426,-493,-697,17,-303,450,277,-444,-523,651,-546,-289,24,-111,-629,-195,162,678,-659,379,-30,-39,-106,412,-305,-597,-68,-427,-503,626,355,658,-199,-422,437,-561,-421,-90,591,-372,-317,253,-62,-466,650,286,-219,94,29,430,-465,-689,677,177,91,-35,-226,219,-546,397,-397,298,463,-168,498,-280,-259,628,-271,-466,464,366,227,-380,-192,-605,-571,-457,497,-517,-573,357,555,-405,-589,383,-23,-351,-560,685,-535,74,18,-123,-118,-685,199,282,-668,-372,639,455,486,427,-335,-375,182,520,53,-458,-502,-469,122,-319,-279,-668,211,-127,645,515,-16,-549,556,-619,625,-492,-63,592,-286,-121,125,-633,444,422,393,396,529,-133,-671,-50,-57,179,454,335,-107,474,395,184,116,-661,33,471,3,365,368,332,16,-197,688,-648,-576,362,-121,294,-363,253,61,241,502,-27,-668,521,414,-509,-334,-100,-229,172,-40,504,-486,-290,512,-21,-459,-652,-278,-130,-165,-186,684,636,-526,-156,693,-62,-61,-511,593,-569,-171,-686,405,657,93,574,-385,379,700,332,40,427,481,147,-587,-361,-664,496,337,-303,555,349,-686,617,-290,468,319,454,19,-299,-518,193,283,671,-392,462,591,-625,-406,-338,453,-141,-358,21,396,590,197,579,-580,161,-180,588,615,-293,463,42,99,227,-140,-673,427,617,-242,93,289,403,482,471,16,-698,-74,567,-606,-26,-170,182,-605,24,337,-357,-567,644,294,514,-212,-520,-493,-678,-150,245,-222,-425,193,19,-263,-107,444,504,459,-327,-326,410,95,-624,692,508,535,433,110,-116,-652,531,-664,194,-211,-544,-5,660,333,-47,-663,3,359,-507,-154,-77,178,452,235,54,-169,377,-314,437,10,675,-620,-622,422,597,431,-55,-262,-341,549,-523,526,-165,321,-323,-73,-615,-248,-399,600,-599,181,-442,-269,177,-162,-384,-277,-639,-531,38,-197,-546,-495,520,428,56,143,406,566,-470,-642,-90,233,411,373,-341,675,20,-444,-684,175,-631,-386,-231,-681,470,440,466,15,393,-155,-648,137,-404,518,283,-260,-682,590,175,356,-179,592,79,-161,-265,487,450,140,276,-390,-59,-312,-387,429,486,-269,-406,-193,-155,29,689,-210,-238,-641,-277,-280,690,588,-524,70,304,-7,674,-28,4,396,334,611,-643,-72,326,471,-438,-350,-481,-595,625,-552,303,509,313,289,-23,657,-244,-637,592,98,-248,14,644,-542,-312,-661,98,369,160,-376,186,-339,500,-628,221,-185,431,-543,-317,-79,-559,54,-238,-228,-604,621,-509,629,232,271,312,-81,623,-280,186,-629,544,-216,643,-24,380,126,-544,-455,-385,-205,239,46,-508,-575,-624,-573,376,-458,481,330,-163,-434,103,-590,-114,349,-392,-253,-470,-271,-232,-634,4,-619,218,535,388,-315,-294,-387,281,-426,414,-594,406,-261,-340,-479,93,224,-157,-556,-238,381,-230,668,319,432,-83,663,307,164,-27,499,-629,615,-257,-684,-644,-647,402,-329,-393,43,-533,-224,402,-448,651,3,-692,-656,60,455,-610,-542,572,167,-609,-548,292,205,-246,-625,-440,-103,-272,666,378,-627,290,-633,-106,-181,23,-324,489,642,648,576,-361,-245,637,489,89,461,-152,180,57,331,-237,564,-405,-600,32,-475,-414,-55,-429,436,261,92,321,410,-246,-612,258,349,26,-519,418,-91,628,306,545,74,345,-563,159,-310,122,559,-536,265,-255,14,462,523,-536,-567,-648,-589,619,-165,-159,171,-479,592,512,43,76,193,-464,92,-394,-669,610,-379,-148,-650,-488,-448,491,-99,-251,-447,-254,-564,-262,636,171,-171,-202,-552,141,55,253,-27,661,663,533,87,-680,-327,284,609,247,358,-171,94,535,-517,467,440,-580,-93,542,260,-149,-638,11,-538,-606,136,595,-405,-680,44,48,229,565,-164,500,-76,-572,-221,-244,-659,-317,-143,191,212,608,-56,-442,372,689,-605,243,-511,-193,612,321,-621,-122,112,696,-190,44,130,132,-214,378,-329,-21,283,-549,234,329,77,61,-513,-255,44,552,449,-615,379,-152,-685,-71,-178,463,65,497,-415,-157,-598,48,592,-92,626,232,-218,-443,28,-699,-198,305,-464,-104,-116,201,-375,-699,259,-55,-680,584,-408,-398,-192,677,480,-568,449,95,358,-490,255,663,-684,-20,-348,181,-551,630,-434,-223,-522,204,422,-571,-288,617,-183,488,79,407,-338,149,-623,447,108,242,317,-604,-671,-44,183,-500,501,-446,327,-456,135,-349,294,228,689,-571,606,24,-572,578,219,-514,470,202,-381,-518,-61,-411,-607,-93,496,660,-370,330,246,357,-190,-492,418,669,-232,-176,125,432,-448,-564,-262,62,-462,604,-399,-443,89,84,-657,399,305,35,116,-43,-88,495,-699,-412,-591,-295,163,-639,-362,510,-325,154,249,534,460,-635,-670,462,-100,34,-518,-549,-667,-360,-458,-418,233,186,-329,-548,75,147,-22,253,55,-54,-92,684,40,610,450,187,-23,520,269,-172,26,-650,506,-434,682,303,570,641,-237,-665,-80,123,9,-343,-390,553,-405,-257,36,-433,365,108,-443,-240,546,53,287,-33,-37,230,-328,161,360,681,-213,71,193,248,-355,-637,-598,-553,198,-640,-666,579,-368,-508,697,145,90,-97,278,-571,-588,-376,-310,-7,-46,-289,-638,-403,576,-559,-213,-573,-582,6,-54,629,136,512,-473,352,-87,228,418,-503,-134,-663,536,122,-40,128,600,-487,623,-6,-320,237,-556,138,123,102,306,-224,-148,-626,-266,316,434,441,335,76,232,-104,-36,451,237,669,-618,192,-181,-483,-227,57,650,562,-448,-456,-588,-612,58,32,-609,247,-137,-94,384,212,-196,-356,-140,-511,208,-114,173,-156,144,-107,96,-191,623,80,-432,-485,130,116,654,688,-18,-89,210,-113,403,-536,-554,-367,189,-199,-386,318,33,442,694,392,522,493,-682,-696,-618,-419,79,-450,-91,-135,-694,-490,-45,11,-595,-389,360,-352,692,593,688,-12,-632,219,-159,649,610,454,-85,-78,-233,-473,158,-129,-94,-358,153,137,410,172,-621,-322,260,-472,-504,-251,213,271,647,98,363,303,88,-285,-326,-203,-132,-331,346,258,-565,-248,-435,544,-308,410,-278,-480,-7,271,450,-472,-422,45,-510,-312,598,-442,608,-168,-300,362,456,419,638,-542,-610,426,195,-121,-559,148,378,122,-649,17,-275,665,-219,-500,438,-299,701,602,-637,-381,516,-297,57,-359,162,-165,384,251,-12,-617,-374,-516,-644,-138,151,463,-437,-188,-280,517,371,-325,540,-154,-297,148,-672,140,692,254,105,11,118,-235,574,102,-483,-621,-5,219,-576,-560,225,116,-513,637,-279,-121,330,317,98,-344,-70,-511,-592,-213,-605,43,-145,693,-221,-572,541,-207,366,-352,554,294,636,-648,-304,611,-620,-385,416,-216,-603,-451,160,-408,-195,-134,-470,-627,-630,408,214,-314,-433,697,402,-70,-29,97,532,412,-222,189,463,485,385,189,-122,-307,100,329,26,-364,170,-391,-442,213,315,399,-327,-36,-561,-349,652,400,-215,622,502,-59,-575,-178,-366,441,-153,-386,-167,-389,-482,302,-312,622,-501,-366,82,366,-114,221,174,-333,-316,-437,-66,-13,208,658,355,241,646,-413,-479,60,218,-216,-523,-386,396,174,398,442,-252,522,461,51,329,-623,-388,-398,-128,268,516,-695,14,-207,287,561,-520,-365,51,590,-337,659,352,630,515,652,-478,-446,-462,428,33,59,648,6,116,-586,130,505,-373,79,-14,-537,263,-604,82,-307,611,521,-238,91,-377,195,471,-457,-188,240,-644,678,-611,-69,-102,516,602,-655,-461,-372,-330,-560,516,446,404,688,641,548,-701,299,-618,-86,-355,681,672,440,510,-484,182,-339,-163,-639,-121,3,-293,479,390,163,320,-582,-422,-185,620,675,306,104,-671,-368,-451,-611,-677,648,-224,241,-256,-174,614,-587,-55,-210,155,-212,-598,544,-88,395,-119,294,692,-307,443,686,345,-505,-518,468,-149,401,-396,-600,-359,370,4,-239,55,556,577,663,-502,534,319,192,247,27,461,-40,-459,-242,-503,179,-557,-177,-116,682,-391,308,25,-354,99,-344,-263,-386,364,528,469,314,567,511,-579,388,-380,-459,379,124,-443,540,441,-56,304,-638,-366,-359,-444,-512,-664,-497,143,224,-665,-133,261,298,-642,163,185,480,-603,75,-675,431,-399,-285,-618,344,-196,553,-251,219,-516,572,-105,-270,-431,405,168,689,-626,-341,-15,-416,-228,569,-312,-277,382,-268,-310,-477,-233,-12,-11,342,407,-249,-638,402,-357,-42,-65,512,529,408,447,-504,-579,-494,660,-328,144,-680,47,-562,-235,476,594,188,519,-251,-87,122,445,314,103,-4,143,-116,431,136,79,4,77,-213,298,37,-165,-499,577,-282,28,-575,-403,109,-184,194,434,349,302,-295,18,632,-239,-246,66,239,568,94,19,634,-670,-95,-377,26,295,-74,-213,124,-319,-42,649,-670,-394,396,89,605,340,-517,-529,-86,-105,109,603,441,-126,-566,-679,350,-311,99,-543,-428,209,-11,336,-387,671,-497,-136,589,528,31,-22,-150,-267,90,351,-51,-369,-271,299,-550,67,-144,523,633,164,-32,-342,-50,-72,248,-138,311,680,349,-354,571,-436,-521,-562,167,-402,-364,172,158,-657,-108,102,-174,5,152,-7,-313,352,537,-160,625,-591,291,501,126,-420,214,-543,287,-74,-116,-334,508,679,365,-607,-610,132,-644,-653,500,-111,477,360,153,-535,283,574,-327,-617,-563,157,109,-519,-271,-630,244,230,-399,-583,-432,-166,389,-585,-58,-252,-99,-66,262,125,-695,112,658,-471,674,-360,273,-320,395,490,-304,534,-18,-365,674,-150,474,-157,-311,-357,-651,-424,-277,490,-117,157,-284,-215,-520,-669,-258,-697,-580,680,619,550,-211,55,280,-680,-266,519,-425,458,-287,615,-195,502,651,-366,-368,-678,-188,-522,-418,638,-30,85,-210,530,448,-655,626,-101,-644,449,297,632,-515,-277,55,-343,653,-47,535,-253,211,373,-367,533,-368,378,-43,99,-33,463,687,555,-232,-254,313,-118,-688,7,413,-511,-98,-522,488,108,-650,545,-36,540,203,116,-584,-485,-224,-214,65,-327,-180,539,-329,539,-574,458,-421,27,-496,-438,-450,-138,159,659,-698,92,-6,380,-39,-398,-93,451,-566,107,283,-382,-51,617,454,-129,-22,276,-535,-580,-359,-37,-502,92,-323,555,-294,-140,-376,679,-3,325,100,-13,-305,204,-297,-265,630,9,622,-127,-135,148,-120,-592,460,656,441,87,601,162,-646,-221,319,506,190,645,-349,586,-435,-241,-456,-41,-95,-429,299,-146,-669,561,142,649,-23,-74,-555,635,-548,543,-66,568,538,68,-373,198,-106,316,64,-433,-527,51,528,-560,511,587,140,-143,-145,283,585,-178,258,310,216,698,22,-162,164,-565,393,-572,339,-8,163,469,-28,569,418,195,-669,95,457,-112,-640,-88,-175,49,269,600,207,624,-318,-629,-57,112,217,-290,554,355,507,381,-116,289,680,-640,-413,30,297,54,532,-644,-470,-118,645,-310,-117,-406,12,335,88,152,-160,-528,383,223,-582,-504,358,-92,10,-640,-123,548,579,335,659,281,270,-42,-128,40,209,380,63,-122,-393,-486,-603,441,537,-72,192,-533,-165,171,-511,20,-40,-620,-682,-343,683,226,437,-632,216,-233,360,535,53,563,-473,367,555,-47,-37,-644,-572,641,272,-514,-133,-341,23,115,-640,137,-303,102,308,-213,-43,-543,635,-59,513,89,136,133,182,-273,-283,-515,422,351,498,297,528,600,-179,507,124,275,308,157,448,432,32,445,305,-238,241,-104,-339,-293,-506,329,670,-618,-362,442,-406,-212,342,557,-515,-401,433,-227,-77,-605,336,516,358,-381,70,425,588,-371,-236,-608,-136,79,-128,39,-480,-267,-574,-92,7,39,357,299,-662,-66,-143,-206,415,-571,-33,588,-556,-554,48,499,490,585,-110,-254,-350,-168,-467,-142,639,141,-328,55,425,-530,236,-159,-112,697,-18,176,-375,455,445,-281,-425,625,256,552,-283,553,612,-476,78,-622,202,499,619,-15,-68,-492,208,-410,-137,430,97,413,-526,500,-382,300,428,476,-412,468,64,42,2,-532,-601,-295,468,213,190,21,136,-145,0,111,-651,-50,292,323,529,-192,616,-54,-548,-624,-530,155,266,49,-325,275,-547,-231,-290,332,-591,289,-278,674,465,328,319,152,-595,636,-47,88,-181,484,-204,-261,-219,-108,-59,582,-60,-655,460,60,-467,-424,-113,-666,395,685,-475,-690,-239,366,552,-267,-543,-240,167,-701,594,46,-327,544,-147,256,361,619,535,112,272,-259,71,-561,-450,471,-574,-656,-331,-646,370,670,-313,441,-654,105,221,321,173,-23,211,246,-246,-582,627,565,-348,405,-156,-9,290,-531,259,-328,-541,-496,551,115,-373,-702,106,121,430,158,-537,-46,436,448,-701,256,376,-681,-27,-138,539,95,416,570,-504,331,-502,-665,-145,-222,653,-677,-182,282,412,198,-181,-33,483,283,645,520,-396,666,410,-112,172,-495,-137,-586,196,-445,-687,-147,-107,-272,-628,-642,-278,522,-185,-53,139,375,169,264,615,318,-331,390,-411,84,-19,-594,121,217,150,-320,-283,58,-509,92,-269,649,613,-592,692,632,-645,245,-583,-58,-386,233,-45,556,454,293,146,118,400,-468,-518,43,605,256,129,-176,625,308,-679,172,421,0,-282,268,186,-361,-654,-211,-496,274,323,180,-543,177,-502,-494,153,-247,-382,-388,-77,135,-691,-191,-407,609,-139,132,226,-596,525,-358,-419,-230,-563,-109,638,-161,450,-526,462,-62,249,229,-102,-213,465,191,-170,418,212,-5,-122,-547,349,-15,411,-62,555,-552,-322,-448,608,-303,-212,392,276,267,629,-563,335,459,96,659,275,216,-218,-481,-22,76,322,688,19,-628,95,-237,-23,-543,-207,279,-276,294,-288,-662,606,-266,495,222,459,700,-246,245,639,-342,593,272,-518,486,302,-300,-219,69,-278,-216,582,-327,547,381,76,493,-176,-331,-582,-510,466,215,-22,78,149,-642,227,145,-350,232,199,423,73,216,-605,294,609,42,63,-466,244,388,-66,445,384,-144,148,132,45,358,648,639,-477,589,-651,-355,-246,30,-170,445,480,-543,-611,569,29,175,-564,-60,523,-306,-181,-177,98,335,-546,-537,186,220,-465,201,-76,-366,-495,-73,201,365,-637,355,-22,65,-177,-373,415,58,280,-587,295,-67,-343,-73,101,-198,380,-501,597,236,-605,-128,98,421,-541,-186,639,283,108,166,-447,216,75,-180,-251,271,240,-261,18,652,507,694,-326,-121,420,466,-504,-697,-300,-518,293,362,317,-421,560,580,-91,-545,-535,-50,58,-542,16,501,97,440,-161,-469,-8,-58,407,-189,70,-273,474,660,600,618,37,-457,-350,367,-178,548,-330,174,592,-81,140,322,-454,496,-2,-419,-617,-84,479,-450,-161,-369,-553,21,-457,-577,154,82,488,-321,484,551,-451,693,189,-43,530,-224,-533,-590,-390,117,537,-648,593,285,-348,185,17,152,-371,-369,1,-96,-180,404,207,-585,-75,-9,463,126,428,429,644,-331,-432,540,701,572,487,446,-395,-203,226,547,36,225,256,626,563,-492,-551,-126,-80,53,-660,458,446,-515,451,-287,409,-421,-676,-358,678,129,-331,-699,-137,381,-589,-320,215,-366,-175,673,179,290,-90,570,-632,39,-63,-376,117,696,-566,394,484,-423,276,239,222,129,160,-593,-195,324,198,-72,-548,9,-138,-33,-640,-182,-518,153,523,206,490,-176,700,-213,132,-106,592,-668,-626,642,14,106,-346,437,-544,-658,116,597,646,-357,103,-108,285,-55,210,-234,635,-430,-356,193,532,-659,188,330,672,-303,602,-11,365,2,406,432,291,454,-577,624,464,-543,-95,-445,501,-469,-130,8,461,-116,220,-461,1,-77,-97,-237,-355,431,78,-183,-667,-405,-418,-463,-75,473,-327,310,377,641,-155,595,481,542,186,-523,433,208,-268,-481,269,-352,-198,280,693,-230,40,-626,462,-390,-78,-129,-342,-461,105,652,-99,-521,-647,449,-167,-471,-425,646,354,73]", 4837)]
  public void Test(string nums, int expected)
  {
    new Solution().MinimumPairRemoval(nums.Array()).Should().Be(expected);
  }
}
