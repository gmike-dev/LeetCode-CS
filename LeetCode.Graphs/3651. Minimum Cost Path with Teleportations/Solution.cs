using LeetCode.Common;

namespace LeetCode.Graphs._3651._Minimum_Cost_Path_with_Teleportations;

public class Solution
{
  public int MinCost(int[][] grid, int k)
  {
    var n = grid.Length;
    var m = grid[0].Length;
    var cost = new int[n, m, k + 1];
    var pointGroups = GetPointsGroupedByValue();
    for (var i = 1; i < n; i++)
    {
      cost[i, 0, 0] = cost[i - 1, 0, 0] + grid[i][0];
    }
    for (var j = 1; j < m; j++)
    {
      cost[0, j, 0] = cost[0, j - 1, 0] + grid[0][j];
    }
    for (var i = 1; i < n; i++)
    {
      for (var j = 1; j < m; j++)
      {
        cost[i, j, 0] = Math.Min(cost[i - 1, j, 0], cost[i, j - 1, 0]) + grid[i][j];
      }
    }
    for (var t = 1; t <= k; t++)
    {
      var minCost = int.MaxValue;
      foreach (var (val, list) in pointGroups)
      {
        foreach (var p in list)
        {
          minCost = Math.Min(minCost, cost[p.i, p.j, t - 1]);
        }
        foreach (var p in list)
        {
          cost[p.i, p.j, t] = minCost;
        }
      }
      UpdateCost(t);
    }
    var result = cost[n - 1, m - 1, 0];
    for (var t = 1; t <= k; t++)
    {
      result = Math.Min(result, cost[n - 1, m - 1, t]);
    }
    return result;

    KeyValuePair<int, List<(int i, int j)>>[] GetPointsGroupedByValue()
    {
      var points = new Dictionary<int, List<(int, int)>>();
      for (var i = 0; i < n; i++)
      {
        for (var j = 0; j < m; j++)
        {
          if (points.TryGetValue(grid[i][j], out var list))
          {
            list.Add((i, j));
          }
          else
          {
            points[grid[i][j]] = [(i, j)];
          }
        }
      }
      return points.OrderByDescending(g => g.Key).ToArray();
    }

    void UpdateCost(int t)
    {
      for (var i = 1; i < n; i++)
      {
        cost[i, 0, t] = Math.Min(cost[i, 0, t], cost[i - 1, 0, t] + grid[i][0]);
      }
      for (var j = 1; j < m; j++)
      {
        cost[0, j, t] = Math.Min(cost[0, j, t], cost[0, j - 1, t] + grid[0][j]);
      }
      for (var i = 1; i < n; i++)
      {
        for (var j = 1; j < m; j++)
        {
          cost[i, j, t] = Math.Min(cost[i, j, t], Math.Min(cost[i - 1, j, t], cost[i, j - 1, t]) + grid[i][j]);
        }
      }
    }
  }
}

[TestFixture]
public class SolutionTests
{
  [TestCase("[[1,3,3],[2,5,4],[4,3,5]]", 2, 7)]
  [TestCase("[[1,2],[2,3],[3,4]]", 1, 9)]
  [TestCase("[[20,25,2],[15,22,15]]", 0, 42)]
  [TestCase("[[3,1],[10,4]]", 7, 4)]
  [TestCase("[[19,10],[23,13],[16,32],[38,41],[30,36],[53,31]]", 1, 55)]
  [TestCase(
    "[[5,0,5,4,8,7,0,3,8],[12,12,9,2,12,12,7,8,9],[9,13,8,11,9,14,6,4,14],[10,13,6,8,9,6,8,12,9],[15,18,9,12,11,18,16,9,16],[17,12,18,17,20,16,15,17,15]]",
    10, 24)]
  [TestCase(
    "[[276,305,299,336,361,36,284,253,310,145,107,264,79,362,146,213,102,45,37,208,77,280,126,281,251,55,273,145,351,361,58,51,294,325,194,198,295,342,353,239,257,154,304,190,54,293,85,220,359,348,48,211,295,209,47,44,17,329,361],[207,113,70,110,53,216,193,53,161,278,374,102,354,228,291,57,245,122,175,206,178,143,121,99,313,191,151,285,85,236,246,276,114,281,186,110,366,311,276,323,199,254,398,345,147,293,259,289,177,224,314,198,221,175,194,231,337,214,263],[177,339,154,104,143,254,113,355,173,213,321,164,265,131,310,221,318,268,182,344,102,276,91,401,285,183,394,316,262,268,265,440,261,195,182,376,188,235,77,240,437,406,387,338,376,228,127,202,308,382,343,159,373,257,295,186,163,233,403],[460,181,115,165,402,239,199,248,465,464,390,162,204,289,426,195,298,293,318,309,198,123,357,305,318,316,444,214,299,283,368,225,138,244,323,435,241,364,232,216,472,133,190,227,413,381,387,384,454,120,371,150,436,135,235,286,395,260,353],[466,404,364,486,247,504,353,169,167,421,490,492,376,251,234,438,318,171,436,455,324,459,455,419,289,418,226,183,414,320,331,214,407,280,477,471,490,397,506,379,423,158,250,295,246,424,265,175,454,228,305,181,337,344,371,376,495,423,310],[214,296,227,366,407,204,467,429,477,259,197,265,525,504,264,408,217,303,195,399,535,270,482,319,309,369,485,472,415,490,419,210,194,278,189,471,394,206,207,462,404,287,232,283,483,205,377,298,530,247,312,224,230,250,448,450,484,534,492],[351,349,556,382,591,489,229,223,298,552,373,590,255,353,470,519,430,375,444,571,484,252,576,369,399,387,533,572,431,422,551,262,568,251,254,368,282,266,582,431,465,537,492,293,390,496,469,238,296,290,400,456,266,337,414,554,261,571,497],[294,290,412,418,399,320,619,523,525,523,301,332,389,461,549,320,282,528,565,435,614,399,506,339,617,303,467,289,557,473,524,276,417,457,502,452,384,549,279,394,263,470,297,268,313,458,369,421,462,541,284,350,552,333,423,284,396,502,390],[363,575,329,555,441,354,296,640,362,385,472,632,647,343,589,516,445,329,462,653,474,369,348,444,653,331,442,520,348,614,579,580,447,544,372,327,509,537,529,604,437,349,376,326,372,535,516,448,448,440,570,528,616,429,507,324,514,357,551],[544,479,585,559,557,520,456,576,701,406,501,495,428,457,456,659,422,347,411,637,570,549,530,468,436,364,651,549,595,466,487,578,436,494,465,610,584,508,479,669,618,657,361,675,609,671,698,617,416,393,699,503,368,413,644,480,640,618,499],[476,621,603,570,380,521,587,688,682,589,501,469,443,737,449,406,380,384,384,433,616,738,715,438,448,500,576,558,520,573,646,625,485,519,403,727,389,659,708,527,404,533,676,506,502,508,665,734,557,380,377,552,724,658,569,552,631,528,614],[735,716,692,417,477,450,414,691,641,557,446,634,627,562,627,432,735,408,630,638,666,739,458,563,650,470,588,687,721,513,456,538,693,741,473,687,470,738,500,503,701,688,704,528,611,594,471,610,489,525,549,667,770,525,611,410,642,584,483],[807,520,567,726,735,504,810,723,666,606,664,683,610,538,727,650,764,779,555,784,762,541,646,754,616,592,625,489,761,685,683,623,799,527,582,545,608,759,665,758,468,635,633,787,667,660,491,680,760,712,697,535,696,729,783,464,710,801,814],[640,693,848,613,697,549,592,531,565,845,564,660,715,495,523,482,801,682,700,718,486,802,795,517,626,558,800,502,547,538,615,702,656,777,736,554,545,840,646,500,818,570,689,642,719,483,671,580,843,507,485,701,845,761,727,814,637,599,680],[755,730,701,540,557,799,737,737,808,557,621,680,520,736,777,568,666,807,595,628,690,693,649,550,600,561,595,594,759,813,863,549,744,655,558,665,638,741,537,544,695,776,885,743,864,747,783,663,618,518,651,693,700,608,771,535,671,749,793],[644,831,823,667,761,774,843,619,631,584,769,613,700,883,776,875,903,642,737,912,638,853,795,904,754,854,845,823,643,642,725,880,916,862,564,583,647,628,887,623,900,784,629,877,710,750,871,825,752,593,691,569,733,795,870,754,846,865,911],[596,707,688,672,672,904,794,719,938,912,865,851,911,928,712,923,878,741,664,854,612,601,873,698,725,749,768,869,897,650,816,958,908,878,894,933,868,775,638,762,885,808,672,791,723,735,929,675,901,853,839,939,685,679,769,687,868,676,668],[981,989,767,860,953,753,814,871,980,894,713,960,882,733,658,667,883,763,847,681,867,633,964,938,754,772,943,653,956,740,808,832,858,698,806,986,671,897,880,685,718,942,737,735,904,877,822,863,799,700,636,670,868,894,797,876,937,743,961],[851,696,851,965,773,827,998,869,1034,1015,699,879,987,900,852,970,794,818,1014,764,815,753,872,833,916,778,852,729,737,950,972,669,751,1035,768,745,1006,797,914,974,970,975,1020,920,899,823,739,687,824,936,840,982,708,704,720,875,1005,908,852],[720,747,783,894,1069,813,791,1015,995,1055,1049,778,1048,950,708,886,1059,1063,983,805,982,759,917,809,946,1025,924,743,985,920,991,948,917,956,975,989,777,983,904,880,1055,741,746,945,724,820,769,826,877,889,772,920,1024,1039,911,767,1026,710,910],[762,1073,846,1017,811,1030,1024,879,1099,884,808,1052,1091,903,831,750,862,1002,853,942,907,918,943,1019,840,770,771,849,1028,940,1086,778,930,1065,772,1065,1021,866,947,1011,1103,1044,1013,758,740,1035,838,1028,765,906,943,1087,910,975,881,982,822,845,792],[1107,1024,1120,894,924,996,1042,928,1106,866,1050,787,1109,919,1075,913,852,842,1004,864,1138,793,1062,905,1122,937,936,926,1054,835,974,851,1064,987,782,987,922,1074,876,912,797,1024,1101,823,978,869,1024,1025,934,830,954,1055,1075,1121,963,1010,837,1053,940],[988,860,917,1159,1121,1002,882,987,1064,1085,816,848,856,844,993,1150,877,1064,933,1010,1027,1181,941,878,963,923,1089,872,830,1148,876,836,1078,904,1085,1094,1008,920,1080,1095,982,1012,1048,941,1017,851,1094,1082,1007,1070,900,943,888,1123,937,1098,898,1123,1113],[870,1198,938,880,1194,933,1161,946,1138,1194,1219,1086,985,930,962,896,1056,1037,1168,1005,993,933,1100,1180,894,964,1107,864,892,1091,882,1058,1193,871,1005,1095,1060,968,1048,1116,883,1201,935,1066,1203,1105,891,1187,1095,1194,1069,853,858,1209,1128,1206,875,1183,967],[1028,938,961,1140,899,1074,942,1180,1030,981,1093,1067,1156,1123,1225,1132,1127,893,1091,1235,1003,980,1071,1141,910,1093,1155,1004,1063,1134,943,953,1017,1130,1242,912,966,1126,1187,1046,1152,1098,1009,923,1126,1040,1177,1254,1234,1256,978,1068,1244,923,1158,1221,952,1256,1161],[932,1166,1270,1259,1010,1059,1087,1203,970,1272,1086,1181,949,1288,941,1040,1258,1004,989,1184,1183,1056,1140,1024,986,1014,1058,1260,1206,1173,1193,964,1120,1272,1285,1129,972,1129,1002,1235,1097,1119,1142,1179,948,1152,989,1227,1263,1125,1042,1177,1271,1049,1076,1172,1177,964,1158],[1057,1023,1047,1328,1086,1003,1320,1210,1021,1157,1239,1003,1303,1016,1082,1160,1297,1137,1187,1127,1052,1243,1087,1134,1182,1264,1101,1115,990,1307,1198,1309,1059,1103,1166,982,1314,987,1049,1070,1158,1106,1169,1242,1127,1289,1284,1220,1112,1194,1011,1033,965,1176,1276,1216,1173,1246,1117],[1119,1189,1135,1358,1074,1093,1218,1316,1001,1251,1330,1219,1227,1037,1369,1302,1070,1205,1243,1296,1232,1317,1364,1359,1346,1151,1189,1024,1303,1230,1307,1276,1309,1265,1354,1110,1019,1348,1194,1305,1313,1118,1309,1096,1171,1195,1303,1107,1367,1160,1168,1291,1024,1298,1152,1300,1293,1335,1249],[1365,1124,1109,1361,1274,1357,1045,1194,1187,1078,1305,1110,1312,1385,1062,1260,1060,1364,1203,1098,1094,1120,1382,1372,1209,1089,1197,1201,1288,1075,1167,1306,1302,1140,1218,1324,1282,1190,1161,1199,1094,1089,1234,1182,1360,1087,1288,1289,1373,1273,1250,1376,1193,1043,1219,1320,1178,1069,1052],[1374,1326,1324,1256,1358,1159,1169,1229,1157,1415,1329,1162,1438,1129,1410,1115,1400,1111,1318,1236,1301,1310,1248,1337,1206,1080,1107,1194,1081,1110,1100,1380,1132,1083,1213,1121,1225,1163,1341,1202,1426,1289,1438,1363,1376,1426,1245,1251,1338,1239,1211,1099,1183,1105,1310,1212,1074,1182,1149],[1217,1357,1265,1284,1442,1263,1351,1398,1475,1419,1298,1389,1126,1152,1134,1387,1261,1439,1299,1230,1264,1209,1376,1211,1439,1455,1473,1466,1184,1235,1320,1336,1369,1130,1134,1139,1340,1156,1389,1114,1300,1347,1202,1329,1129,1461,1126,1167,1285,1388,1307,1223,1275,1472,1389,1148,1454,1267,1228],[1485,1449,1196,1323,1447,1472,1181,1157,1319,1505,1147,1310,1473,1361,1166,1166,1310,1386,1484,1487,1381,1312,1256,1162,1497,1151,1436,1191,1314,1226,1203,1445,1452,1296,1304,1405,1439,1241,1429,1508,1188,1372,1296,1472,1291,1261,1381,1481,1498,1478,1376,1383,1323,1472,1294,1441,1168,1447,1309],[1220,1288,1383,1388,1388,1376,1297,1207,1510,1230,1430,1394,1342,1367,1305,1210,1304,1390,1432,1428,1208,1328,1249,1502,1213,1387,1379,1426,1531,1318,1444,1242,1262,1552,1320,1281,1420,1553,1369,1350,1400,1471,1281,1362,1390,1191,1349,1278,1370,1344,1432,1261,1304,1267,1406,1354,1373,1442,1332],[1309,1582,1528,1511,1236,1267,1282,1362,1423,1398,1287,1552,1503,1351,1506,1274,1412,1272,1335,1479,1257,1430,1470,1462,1288,1411,1358,1498,1332,1524,1366,1305,1547,1511,1466,1369,1225,1569,1587,1284,1455,1557,1324,1487,1576,1569,1227,1241,1558,1432,1538,1309,1589,1522,1541,1333,1583,1547,1336],[1284,1500,1617,1377,1614,1335,1305,1423,1308,1469,1297,1397,1264,1414,1585,1603,1286,1542,1428,1445,1566,1537,1414,1538,1557,1416,1436,1441,1358,1343,1320,1531,1599,1623,1354,1620,1431,1503,1390,1407,1608,1586,1592,1528,1620,1475,1272,1277,1289,1504,1465,1556,1542,1591,1612,1506,1258,1321,1368],[1603,1619,1625,1343,1380,1506,1562,1357,1319,1476,1625,1594,1477,1351,1603,1632,1534,1314,1445,1444,1396,1653,1492,1435,1506,1363,1366,1323,1655,1407,1634,1665,1487,1592,1385,1375,1466,1616,1315,1580,1433,1467,1636,1481,1587,1430,1330,1496,1303,1555,1444,1558,1403,1428,1506,1305,1295,1430,1468],[1676,1610,1375,1700,1512,1667,1530,1685,1440,1664,1388,1344,1333,1584,1547,1538,1467,1624,1553,1398,1571,1514,1472,1635,1496,1379,1640,1537,1607,1448,1433,1531,1456,1535,1654,1534,1605,1338,1648,1523,1423,1479,1388,1427,1527,1492,1637,1659,1590,1404,1656,1555,1509,1695,1446,1700,1638,1419,1344],[1414,1549,1636,1460,1521,1680,1460,1492,1645,1392,1704,1513,1719,1714,1406,1529,1631,1694,1637,1488,1443,1545,1370,1562,1634,1643,1539,1541,1522,1557,1585,1585,1487,1705,1541,1396,1530,1401,1536,1432,1630,1630,1467,1649,1633,1573,1715,1438,1386,1537,1451,1588,1518,1617,1431,1536,1488,1396,1681],[1420,1541,1650,1565,1539,1773,1595,1662,1510,1675,1570,1560,1689,1502,1767,1732,1757,1417,1411,1529,1675,1432,1688,1465,1746,1445,1679,1429,1670,1728,1460,1739,1741,1701,1748,1645,1704,1550,1522,1670,1469,1702,1618,1589,1669,1642,1712,1615,1598,1613,1618,1414,1475,1499,1558,1504,1523,1481,1534],[1688,1797,1747,1779,1655,1564,1728,1529,1568,1444,1733,1448,1732,1658,1574,1535,1698,1763,1719,1697,1742,1534,1571,1559,1475,1547,1699,1581,1606,1531,1588,1573,1541,1777,1696,1781,1775,1519,1755,1645,1673,1590,1799,1489,1806,1610,1740,1714,1726,1648,1517,1514,1644,1456,1732,1682,1599,1584,1663],[1691,1801,1582,1666,1508,1684,1529,1577,1508,1586,1516,1690,1672,1843,1511,1700,1719,1702,1726,1685,1725,1600,1531,1726,1783,1549,1540,1618,1562,1807,1556,1825,1629,1816,1797,1589,1799,1485,1715,1835,1545,1742,1585,1510,1811,1681,1803,1711,1623,1528,1499,1582,1847,1496,1706,1678,1580,1794,1494],[1804,1610,1576,1688,1747,1885,1626,1777,1589,1578,1665,1772,1831,1626,1560,1797,1751,1563,1683,1711,1578,1717,1741,1580,1582,1746,1661,1646,1755,1638,1829,1605,1519,1726,1758,1843,1648,1832,1602,1751,1829,1757,1834,1792,1521,1517,1827,1693,1772,1784,1628,1863,1585,1639,1848,1822,1810,1691,1625],[1573,1829,1872,1684,1635,1879,1896,1801,1606,1584,1912,1801,1800,1696,1579,1635,1660,1566,1707,1596,1614,1786,1575,1777,1707,1731,1839,1910,1895,1676,1560,1752,1801,1820,1900,1824,1571,1871,1767,1888,1673,1751,1844,1783,1611,1603,1594,1686,1556,1910,1886,1637,1794,1819,1764,1902,1637,1731,1570],[1851,1903,1768,1782,1743,1925,1798,1795,1628,1910,1938,1764,1797,1601,1887,1700,1903,1839,1881,1655,1763,1846,1909,1954,1922,1667,1959,1961,1961,1682,1850,1954,1689,1912,1901,1932,1629,1738,1959,1787,1604,1833,1660,1674,1960,1880,1893,1776,1638,1934,1943,1635,1873,1731,1636,1777,1658,1822,1805],[1954,1835,1995,1750,1990,1970,1695,1955,1712,1997,1788,1891,1946,1984,1671,1628,1751,1769,1854,1739,1934,1707,1775,1646,1794,1931,1663,1828,1962,1629,1751,1971,1640,1993,1690,1806,1829,1629,1730,1629,1899,1901,1767,1945,1870,1713,1749,1898,1902,1738,1694,1700,1664,1916,1862,1975,1830,1900,1866],[1929,1954,2016,1890,1853,1780,1945,1804,1665,1842,1941,1774,1701,1778,1678,1874,1802,1795,1730,1833,1874,1856,1697,1830,1712,2029,2011,1886,1728,1790,1689,1884,1788,2024,1865,1699,1723,2007,1943,1712,2005,1836,2001,1990,1935,1736,2029,1818,1755,1708,2021,1784,1850,1812,1998,1708,1726,1758,1873],[1753,1861,1880,1952,2067,2061,1929,1801,1933,1809,1752,1728,1810,1764,2050,1894,1960,1804,1773,1832,1729,1787,2016,1710,1864,1782,1826,1849,2050,1739,1802,1985,1713,1713,2055,1825,1896,1839,1885,1758,1890,1823,1748,1949,2002,2033,1709,1958,1819,1850,1936,1881,1958,1767,1787,1763,2026,1908,1772],[2107,1765,2100,1748,1963,2065,1997,1850,1741,1817,1772,1743,2026,1861,2073,1814,1916,2006,1952,1806,1875,1991,1812,1993,1803,1966,1876,1741,1878,1838,1765,1781,1934,2049,2038,1968,1859,2109,1892,1812,2055,2021,1862,1790,1936,2022,1927,1875,1999,2033,1825,1820,1836,1804,2102,1924,2004,2036,1751],[1788,1851,2146,1822,1937,1967,2142,1868,2024,1807,1888,2078,2118,2083,1929,2047,2121,1827,2046,1890,1880,1895,1883,2119,1934,1965,2067,1798,1777,1791,2098,2146,2027,2030,1828,1932,2131,1973,1998,1786,2021,1856,2079,2011,2114,2087,1851,1986,2004,2083,1966,1857,1914,2072,2118,2094,2011,1911,2049],[2064,1874,2092,1866,2002,1830,1970,2147,2027,1934,2176,2066,2071,2109,1956,2067,1821,1948,1845,2119,1947,2095,2108,1821,2170,1830,2074,2003,1890,2047,2168,1817,1945,1955,1999,1986,2009,2144,2017,2108,2087,2136,2083,2147,2123,1814,1968,1893,1850,2138,1832,2125,2161,2036,2137,2165,1891,1893,2040],[1890,1968,2083,1922,2134,2166,2050,2144,2077,2197,2178,2217,2084,1883,2025,2065,2171,1993,2095,1890,1910,2139,1994,2199,2148,1894,2107,2161,2057,2186,1868,2092,2215,2210,1956,2120,2113,2055,2012,2051,1901,2168,2218,1936,1865,2074,1964,2016,2076,2159,2045,2016,2070,1927,2034,2023,2050,1969,2051],[2032,2023,1974,1946,2060,2084,1995,2097,2168,1948,2182,2046,2009,2004,1975,2114,2153,2072,1978,1892,2196,2076,2126,1914,1939,1978,2037,2228,2063,1904,2051,2176,2236,1907,1955,2026,2192,2204,2036,2176,1951,1976,1952,2037,1966,2253,2098,2240,2135,1916,2073,2117,2081,2131,2024,1920,1963,1971,2032],[1955,1959,2143,2121,2261,2062,2287,2237,2210,2173,1925,2163,2020,2013,1945,2249,2083,2131,2202,2130,1936,2288,1970,2088,2118,2241,2035,1928,2279,1947,1925,1984,2125,2093,2240,2155,2167,1980,1941,1992,1928,1940,2099,2127,2281,2009,2265,2151,2280,2158,2204,1938,2063,2222,2215,1964,2218,2144,2042],[2137,2209,2234,2224,2165,2258,1985,1970,2301,2164,2284,2187,2268,2136,2138,2254,2217,2132,2196,2002,2135,2088,2095,2016,2117,2217,2253,2186,1986,2049,2080,1982,2154,2123,1991,2073,2055,2255,2277,1969,2016,2199,2099,2286,2194,2173,2284,2248,1981,2067,2180,1962,1967,2173,1972,2156,2319,2096,2217],[2140,2193,2336,2311,2224,2181,2019,2276,2342,2188,2362,2061,2043,2193,2054,2195,2121,2357,2267,2264,2205,2178,2195,2152,2224,2265,2290,2032,2028,2073,2045,2100,2072,2285,2037,2217,2339,2120,2137,2203,2244,2312,2046,2264,2248,2205,2066,2283,2287,2311,2244,2124,2305,2147,2150,2164,2163,2005,2053],[2351,2303,2222,2339,2398,2181,2205,2349,2129,2117,2390,2380,2258,2344,2055,2070,2266,2337,2212,2398,2301,2315,2203,2152,2353,2196,2378,2305,2342,2174,2315,2077,2378,2208,2153,2269,2159,2308,2108,2190,2147,2270,2336,2401,2316,2246,2348,2354,2164,2236,2317,2114,2299,2399,2180,2065,2198,2271,2251],[2197,2124,2252,2089,2278,2079,2282,2403,2442,2125,2396,2204,2377,2333,2215,2170,2301,2094,2096,2303,2102,2146,2433,2122,2262,2369,2269,2233,2371,2163,2165,2340,2439,2369,2274,2148,2369,2257,2363,2337,2165,2130,2084,2219,2177,2423,2204,2330,2363,2105,2229,2195,2153,2351,2099,2132,2410,2097,2150],[2268,2187,2447,2192,2234,2472,2214,2282,2143,2299,2264,2426,2113,2380,2325,2424,2322,2370,2318,2471,2111,2399,2116,2160,2333,2362,2426,2464,2146,2463,2239,2431,2445,2230,2156,2189,2233,2287,2425,2269,2317,2299,2393,2364,2267,2159,2309,2429,2184,2299,2440,2353,2463,2151,2336,2151,2335,2409,2123],[2363,2207,2242,2278,2445,2254,2471,2436,2274,2174,2461,2254,2216,2316,2290,2266,2332,2203,2516,2427,2212,2161,2174,2456,2322,2306,2271,2324,2507,2438,2304,2269,2287,2489,2444,2481,2354,2309,2458,2283,2371,2298,2423,2179,2461,2146,2502,2462,2429,2292,2155,2148,2515,2278,2322,2278,2404,2275,2512],[2280,2442,2436,2231,2204,2501,2349,2414,2353,2249,2281,2553,2370,2552,2389,2523,2483,2384,2495,2420,2187,2286,2524,2422,2424,2204,2212,2523,2309,2532,2275,2414,2245,2537,2480,2523,2531,2275,2295,2549,2225,2238,2472,2491,2256,2204,2510,2512,2186,2295,2199,2299,2193,2205,2493,2198,2373,2301,2353],[2500,2287,2298,2541,2512,2546,2261,2329,2389,2519,2531,2314,2411,2316,2244,2373,2487,2456,2432,2347,2410,2572,2441,2448,2422,2564,2552,2340,2550,2409,2337,2468,2527,2562,2234,2225,2508,2471,2527,2278,2464,2409,2263,2466,2562,2497,2541,2232,2535,2346,2566,2312,2347,2268,2376,2221,2244,2580,2341],[2314,2339,2445,2523,2494,2446,2479,2575,2395,2575,2616,2392,2495,2542,2351,2619,2586,2532,2311,2410,2296,2528,2326,2360,2261,2476,2613,2284,2302,2510,2612,2491,2481,2323,2577,2473,2598,2623,2490,2377,2621,2450,2620,2380,2337,2339,2324,2274,2497,2293,2398,2378,2412,2347,2449,2547,2587,2592,2393],[2525,2309,2490,2465,2477,2385,2515,2600,2509,2404,2452,2423,2535,2605,2651,2528,2539,2456,2411,2558,2320,2336,2547,2569,2585,2424,2528,2470,2467,2469,2360,2587,2369,2455,2323,2391,2571,2604,2526,2651,2528,2604,2520,2632,2464,2383,2410,2640,2601,2403,2310,2373,2352,2412,2573,2597,2340,2496,2545],[2484,2506,2564,2666,2612,2383,2348,2635,2588,2386,2439,2422,2369,2353,2541,2427,2379,2401,2675,2553,2494,2423,2436,2615,2586,2499,2558,2367,2512,2353,2484,2349,2576,2695,2536,2465,2691,2457,2453,2360,2655,2381,2489,2361,2347,2434,2398,2469,2507,2460,2525,2459,2444,2404,2538,2411,2363,2673,2647],[2529,2381,2645,2611,2470,2451,2565,2428,2497,2649,2469,2422,2454,2638,2454,2369,2647,2530,2421,2589,2535,2687,2525,2656,2541,2519,2654,2676,2481,2423,2624,2448,2525,2391,2397,2504,2426,2514,2574,2735,2400,2408,2519,2731,2417,2486,2425,2461,2709,2666,2508,2377,2669,2662,2724,2373,2387,2665,2573],[2684,2423,2668,2502,2576,2568,2566,2580,2640,2644,2410,2707,2658,2652,2458,2658,2750,2535,2683,2512,2727,2464,2476,2603,2596,2749,2646,2718,2726,2568,2560,2555,2576,2766,2633,2756,2504,2763,2544,2673,2722,2658,2463,2620,2451,2716,2573,2746,2433,2736,2763,2577,2435,2576,2410,2759,2431,2485,2709],[2780,2592,2599,2702,2729,2515,2665,2673,2584,2617,2726,2672,2741,2646,2743,2571,2685,2448,2643,2732,2658,2769,2528,2692,2687,2639,2798,2545,2717,2485,2779,2485,2598,2594,2618,2683,2504,2795,2810,2660,2809,2511,2714,2645,2799,2664,2658,2807,2729,2664,2691,2477,2577,2692,2528,2503,2628,2576,2849]]",
    7, 15170)]
  [TestCase(
    "[[129,4,865,364,479,200,640,801,423,732,438,867,384,10,256,565,519,868,501,390,631,513,87,293,637,830,163,338,209,639,648,513,70,153,656,797,302,617,701,50,283,182,298,16,46,303,786,266,766,1,545,258,272,74,493,128,563,352,268,77,786,381,78,320,681,440,309,402,594,813,290,200,245,721,433,575,334,466,203,771],[584,701,902,320,723,865,252,522,314,868,164,612,747,296,223,932,240,145,120,162,867,944,332,487,89,592,341,836,713,109,556,827,890,938,804,117,192,322,668,788,506,541,584,163,874,362,879,494,857,165,856,297,770,249,612,569,583,633,364,230,833,523,606,255,664,372,258,794,635,758,514,609,461,572,160,628,487,138,807,91],[457,370,868,883,188,651,557,976,456,630,814,673,487,1004,387,424,768,353,605,729,260,189,898,302,841,222,265,374,734,663,287,709,204,466,354,489,335,578,496,485,578,835,663,468,189,581,615,468,946,939,1040,903,194,304,354,252,248,211,393,567,529,1041,577,761,407,857,370,834,685,610,351,491,457,497,640,843,402,847,479,422],[1010,270,367,579,487,966,679,575,1130,698,755,975,312,672,285,645,448,1097,660,758,397,266,302,293,906,796,544,978,428,320,1085,1019,617,819,607,1106,440,1065,261,489,714,531,264,1047,353,1052,449,488,472,1091,990,280,1062,571,897,606,429,715,369,1110,346,981,954,519,961,975,667,1038,978,725,626,438,726,1023,494,469,398,833,337,905],[707,1167,1186,654,440,383,683,1157,949,1214,408,888,875,1136,935,898,1138,897,664,913,1103,590,582,749,1164,469,404,1095,885,966,584,366,1019,1067,377,1134,1208,1032,762,797,906,788,692,712,443,423,373,946,574,753,898,1034,897,423,401,1063,485,379,800,373,1173,1103,1114,749,809,531,459,382,1199,1158,803,998,383,874,472,639,951,978,1050,399],[566,803,841,882,688,488,1184,824,1126,487,562,520,511,742,985,694,1032,596,892,809,819,910,699,548,582,1168,656,1109,543,1268,1150,639,1019,757,730,768,1089,455,888,921,1072,1057,896,1161,742,1231,672,458,721,784,1056,1291,1164,1248,1002,1025,1013,462,1148,570,592,661,591,773,1198,951,472,973,840,818,1166,714,1222,451,591,835,452,1019,1188,834],[684,589,1311,1251,954,1334,848,680,1114,1283,1365,1368,1243,980,1369,1067,1153,714,793,732,801,738,930,928,1017,813,990,1228,942,1223,694,635,1308,1261,1101,790,983,1344,1219,1352,878,1368,1061,749,1379,578,550,783,723,940,812,1373,1229,589,1097,849,1131,1196,574,1060,1181,907,1003,929,531,1182,985,760,796,629,603,1077,746,562,717,1324,666,827,1251,1050],[1026,1478,1180,1420,1461,1084,645,686,678,981,1470,1399,1421,655,1410,638,1166,928,1054,1274,1423,1114,1079,974,916,1106,1208,946,942,890,1082,863,1060,901,1021,1208,1048,672,672,1156,1309,1334,1031,698,1013,1449,981,1049,767,885,972,1156,1238,1160,1024,652,725,872,1399,1136,620,1160,1169,1216,1029,742,657,1458,1160,1391,1024,1363,1096,783,1241,1360,1249,698,1403,1006],[882,1303,1196,873,1136,1410,905,946,1472,1119,1327,952,806,1348,1384,1281,1309,778,1456,1533,956,1133,1208,1069,1149,1186,1253,1272,1451,1067,832,1506,1063,1298,900,1388,971,975,1256,862,946,1272,1337,1029,1402,973,1108,1411,1467,884,1060,1162,713,863,711,1454,756,1291,1317,960,696,976,1218,1275,839,1530,1190,746,751,959,967,1546,718,1294,1301,1318,826,1307,1282,1414],[1313,1081,1587,1538,1548,817,1084,1134,821,1091,1396,929,927,1601,1331,1089,1163,1586,1402,1287,1428,1041,1254,1108,909,1163,1379,1193,794,1357,1190,1633,1482,857,855,1395,972,1400,803,876,1341,1287,868,1614,845,1647,1240,1118,1216,1590,1071,1557,1035,1231,1152,1069,1182,1255,1411,1604,832,1376,932,963,1119,1280,818,835,1540,1274,1029,789,1147,1300,1270,1197,1278,1259,1334,1056],[1487,1149,1557,1312,1671,1407,1091,1353,1441,1617,1169,1465,1507,1153,1469,1012,1238,1251,1527,1687,1570,1475,1525,1538,1572,906,1578,1489,1151,1689,963,1629,1566,1457,1515,1539,1504,1507,1119,1171,1604,1219,1254,1659,1496,1625,1299,1368,1198,1598,1416,895,1162,1523,1256,1527,1439,959,1409,1469,1218,1034,1107,1438,1135,1190,1336,937,1133,900,1702,1003,1698,1009,1534,1324,1203,1509,1183,1411],[1003,1180,1583,1648,1324,1816,1754,1056,1000,1094,1393,1049,1055,1815,1385,1798,1817,1434,1435,1119,1754,1061,1003,986,1702,972,1595,1378,1708,1506,1036,1394,1523,1717,1611,1030,1376,1629,1760,1435,1568,1464,1057,1325,1069,1743,1624,1426,1632,976,1265,1296,1517,1256,1549,1306,1118,1421,1766,1582,1722,1067,1431,1066,1351,1627,1479,1554,1607,1680,1723,1632,1654,1782,993,1390,1728,1799,1616,1206],[1300,1434,1348,1681,1143,1440,1704,1793,1898,1640,1520,1477,1132,1869,1390,1687,1717,1213,1841,1214,1688,1739,1751,1767,1104,1646,1335,1594,1447,1092,1270,1531,1404,1806,1101,1090,1219,1777,1902,1244,1777,1726,1842,1096,1124,1512,1710,1575,1320,1379,1527,1417,1082,1063,1191,1063,1511,1204,1834,1187,1337,1205,1295,1466,1431,1376,1754,1653,1606,1909,1344,1630,1496,1065,1091,1769,1656,1714,1781,1585],[1245,1455,1821,1999,1503,1488,1761,1158,1552,1637,1473,1262,1692,1290,1273,1476,1408,1365,1858,1853,1878,1559,1566,1594,1464,1405,1557,1660,1515,1335,1556,1637,1839,1262,1245,1193,1576,1245,1297,1140,1326,1978,1441,1718,1233,1263,1970,1839,1805,1410,1619,1564,1208,1269,1731,1514,1697,1882,1784,1969,1966,1379,1713,1880,1659,1773,1848,1614,1688,1878,1638,1211,1135,1154,1811,1228,1170,1816,1656,1691],[1567,1858,1732,1395,1580,1531,1495,1509,2070,2086,1335,1345,1590,1968,1838,1388,1554,1860,1902,1476,1413,2042,1238,1268,1357,1258,1266,1836,1769,1933,1313,1989,1513,1849,1784,1776,1301,1570,1404,1916,1784,1446,1435,1883,1634,1705,1764,1681,1853,1304,1691,1275,1857,1819,1748,1537,1456,1880,1393,1468,1346,1811,1296,1405,1979,1342,1616,1473,2048,1829,1948,1941,1533,1481,1654,1984,1971,2053,1928,1915],[1814,1337,1556,1779,1999,1411,2119,2104,1709,1982,1928,2036,1599,1538,2006,2000,1513,1592,1602,1577,1818,1897,2093,1920,2138,1833,2025,1366,1389,1305,1470,1537,1600,1682,1523,1547,1422,1704,1754,1810,1507,1942,1529,1538,1334,1732,1919,1877,1668,2075,2026,1643,1473,1320,1499,1502,2106,1896,1689,1716,1401,2086,2093,2111,1961,1398,1913,1415,1474,1432,1473,1405,1768,1684,1526,1682,1757,1371,1574,1403],[1462,2058,1519,2249,1898,1603,1955,1482,1410,2242,1574,1965,1453,1691,1842,2060,1695,1980,2244,2256,2212,1852,2116,1932,2198,1544,1929,1646,1932,1445,1660,1630,1573,1834,1682,2087,1422,1979,2114,1935,1495,2139,2241,1551,2173,1787,1416,2030,2056,2136,1453,2086,1814,2195,1707,1846,1754,1734,1556,1701,1947,1780,1776,1467,1422,1910,1903,2176,1567,1587,2065,1969,1544,1407,1582,1738,1636,2126,1998,1481],[1664,1538,1536,1823,1731,1740,1692,2317,1898,1693,1678,1669,1869,1883,2158,1899,1551,2147,2064,1994,1566,2109,1575,2160,2165,1875,2116,2259,2265,1536,2032,1521,1772,1515,1540,1905,2195,2153,2172,1995,1571,1503,1752,1515,1968,2109,2335,1954,1887,2144,2041,1995,1731,2148,1702,2248,1988,2230,2221,1980,2105,1770,1536,2075,1638,1684,2228,1784,1752,1723,1944,1500,1969,1784,2327,2051,2144,1496,1668,1834],[2268,2026,2162,2180,2294,2259,1801,1690,1855,1650,1797,1848,2314,2067,2069,1569,1907,2208,1622,1911,1803,2116,1787,1707,1627,1599,1934,1738,1808,2294,2379,2185,2062,1755,2263,1573,1720,1616,1800,1895,1680,2366,1864,2253,2029,1620,1889,2384,2221,1616,1685,1930,2221,1926,1701,2044,1825,2125,2130,2319,2110,2397,1935,1672,1846,1826,2316,1712,1750,1660,2250,1990,1761,1954,1761,2347,1704,2424,2201,2416],[1913,1852,1722,2504,1676,1669,1974,1721,2412,2393,2023,1747,2163,1696,1899,2358,2121,2157,1814,2050,2233,1746,2371,1723,1885,1875,2400,2188,2425,1744,2208,2378,1675,1840,1927,1854,2139,2436,2502,2284,2249,1816,2485,2121,1778,2045,2242,2191,1856,1833,1815,1725,2157,2237,2120,1873,2268,1886,1777,2076,2307,2492,1891,1826,2190,1790,2373,2336,2226,2259,1931,1708,2234,1887,1992,2489,1887,2060,2398,1891],[2005,2221,2554,2060,2239,2461,2096,1875,2593,2043,2145,1892,2078,2274,2452,2549,2568,2472,2587,2110,2430,1874,2342,2199,2117,2530,2495,1904,1849,2003,2546,2490,2019,2393,2406,2131,2529,2311,1899,1778,2512,1792,2058,2404,2321,1947,2084,2224,1921,2095,2454,1982,2579,2325,2308,1847,2088,2466,1862,2251,2008,2299,1760,2186,1879,2415,2166,1862,1823,2275,2294,1933,1922,2133,1913,2362,2107,1817,1837,1808],[2129,2359,1953,2036,2394,2299,2187,1880,2453,2068,2007,1999,2051,2196,2410,1867,1875,2184,2403,2141,1997,2195,2281,2221,2306,1983,2330,2456,2021,2570,2167,2436,1938,2458,2252,2162,2299,2538,1945,2628,2240,1843,2307,2483,2002,1982,1880,2611,2433,2436,2399,2458,1829,2201,1891,2378,2560,2419,2373,1966,2460,2127,2460,2587,2354,2530,2618,2650,2019,2600,2587,2261,2044,2260,2337,2081,2066,2572,2170,2017],[2520,2067,2091,2557,2023,2122,2597,2661,2716,2172,2563,2689,2358,2727,2723,2523,2336,1998,2283,2268,2668,2438,2537,2494,2160,1930,1963,1931,1995,2676,2168,2390,2689,1954,1967,2579,2207,2574,2198,2324,2312,2147,2722,2001,2025,2517,2477,2018,2438,2633,2221,2006,2279,2759,2074,2093,2063,1991,2119,2295,2735,2528,1948,2393,1948,2338,2398,2616,1980,2685,2146,2037,2352,1967,2178,2315,2173,2634,2591,2061],[2036,2296,2024,2700,2811,2841,2598,2266,2440,2367,2227,2713,2234,2728,2348,2750,2320,2454,2465,2404,2012,2418,2071,2756,2017,2003,2477,2628,2358,2195,2217,2110,2180,2019,2760,2690,2215,2097,2567,2307,2224,2048,2838,2176,2395,2739,2642,2588,2494,2730,2104,2769,2103,2787,2300,2190,2382,2411,2632,2481,2453,2451,2008,2399,2602,2850,2450,2516,2075,2259,2568,2278,2693,2864,2364,2620,2810,2091,2161,2696],[2231,2384,2349,2530,2487,2752,2186,2404,2641,2233,2893,2296,2672,2903,2735,2239,2419,2399,2956,2902,2745,2724,2424,2151,2684,2262,2669,2276,2229,2286,2812,2440,2827,2663,2507,2275,2201,2697,2213,2125,2233,2572,2742,2802,2581,2741,2651,2354,2188,2941,2237,2157,2952,2677,2607,2340,2497,2223,2192,2133,2193,2513,2492,2927,2476,2910,2911,2476,2597,2799,2786,2539,2861,2300,2242,2896,2224,2432,2479,2288],[2434,2217,2248,2982,2656,2475,2462,2521,2530,2268,3000,2779,2693,2193,2260,2707,2842,2544,2887,2416,2989,2470,2841,2245,2930,2344,2694,2673,2389,2577,2317,2289,2407,3011,2773,2847,2612,2271,2273,2815,2311,2904,2872,2228,2817,2847,2213,2681,2298,2924,2661,2618,2229,2809,2781,2552,2184,2791,2899,2658,2276,2631,2626,2291,2254,2501,2503,2310,2384,3042,2273,2318,2767,2645,2999,2334,2249,2455,2564,3011],[2267,2505,2942,2716,2933,3002,2807,2454,2924,3129,2391,3029,2807,2883,2975,2534,2590,2698,2742,2330,2838,2590,2800,2323,2429,2695,3055,2827,2297,3016,2807,3001,3035,2745,2603,2852,2892,2883,2727,2410,2580,2834,2426,3121,3005,3118,2615,2477,2899,2798,3023,2337,2774,2543,2661,2819,2924,2456,2805,2702,2481,2316,2296,3084,2858,2508,2385,2884,2947,3089,2581,2370,2931,2275,2782,2859,2518,2386,2538,2856],[2916,2354,2503,3007,2386,3042,3157,2642,3135,3133,2879,2400,2500,3157,3016,2931,2863,3042,2555,3122,2950,2450,3110,2639,2924,2442,2530,3067,2758,2447,2832,2559,2902,3080,2539,2583,2425,2582,2761,2584,2628,3103,2397,2406,2746,2575,3100,2709,3061,3048,2673,2478,2536,2371,2352,3022,2434,3214,2381,2697,2839,2522,2351,3058,2424,2896,3055,2730,2669,2990,2933,2360,2551,2657,2997,2556,2512,2649,2647,2527],[3012,2612,2900,3176,3041,2531,3066,3185,2976,3090,2612,2892,2758,3021,2695,2563,2680,3015,3292,2480,2960,2768,2456,2536,2852,3257,2855,2833,2758,3199,3199,2940,3180,2709,2928,2461,2998,2817,3060,2786,3066,2876,3078,3277,2467,2592,3068,2492,2893,2828,3213,2507,2569,2611,2458,3101,2664,3129,3071,2795,2733,2517,3168,2987,3133,2769,2689,2717,2962,2681,2444,2827,2565,2892,3168,3000,2515,2662,3166,3008],[2569,2725,3362,2918,2580,3052,3260,3180,2568,2758,2720,2978,3024,3223,2524,3280,3082,3142,3344,2843,3239,3157,2852,3103,3237,2976,2826,2756,2695,3366,3037,2669,3274,2647,3306,3070,3216,2671,2728,3307,2803,3343,3330,3211,3281,3352,2959,2539,3212,2621,2737,3375,3318,3276,3182,3226,2998,2821,3376,3276,2649,3068,3023,2726,3381,2552,2645,3146,2529,3372,3104,2907,3311,2683,2837,2730,3362,3380,2700,3059],[3111,2774,3447,2765,2694,3099,2977,3275,3261,2830,2619,3066,2977,2794,3394,2931,3189,2838,2974,2664,2638,2849,3037,3131,3267,3389,3226,3068,2943,2938,2923,2799,3351,3137,3033,3300,2785,3240,3149,3233,3414,3280,3140,3034,2850,3137,2838,3275,2712,3439,2610,2894,2914,3347,2637,3451,3062,3371,2616,3289,3409,3239,2856,3433,3128,3149,3008,2779,3368,3151,3253,3149,3087,3360,2695,3121,3139,3087,2822,2938],[3237,2942,3359,3342,3298,3306,3203,3173,2838,3196,3432,2896,2706,3235,3558,2983,3559,3324,3331,3340,2782,2796,3029,2713,3417,3091,3040,3313,3440,3077,2919,3180,3029,3049,3442,3169,3159,2745,2927,2828,3035,3450,3432,3459,2735,3445,3119,3510,2923,2870,3020,2932,3201,3029,3441,3265,3063,2890,3412,3219,2833,2883,3346,3139,2909,2796,2890,2712,3401,2783,3362,3472,3393,2803,3167,3521,2986,2840,3109,3178],[3220,2799,3509,3231,3192,3498,2854,3433,3452,3150,3357,3089,3154,3233,3589,2823,3594,3492,3051,3390,3403,3542,3632,3472,2900,3149,3470,2927,2875,3468,3045,3603,3358,2791,3212,2911,3165,3483,2825,3473,3350,2909,3262,3303,2827,2971,2880,2975,3347,3260,3577,2799,3651,3316,3163,3149,3400,2869,3487,3338,3023,3478,3183,3293,3401,3397,3569,3417,3213,3558,3478,3207,3518,3174,3454,3108,3153,3598,3398,3324],[3204,2956,3104,3670,3363,3359,3394,3134,3321,3561,3507,3633,3548,3493,3568,3199,3667,3516,3489,3114,3707,3665,3191,3591,2905,3331,3591,3483,3059,3089,3729,3624,3725,3302,3222,3260,3161,3276,3503,3197,2997,3141,2982,3321,3695,2981,3000,3430,3336,3721,3536,3237,3575,3343,3641,3145,3266,3228,3702,3519,3287,3139,3685,2910,3620,3265,3251,3387,3710,3326,3287,3231,3345,3180,3437,3651,3208,3245,3720,3293],[3469,3496,3748,3544,3211,3471,3783,3036,3094,3034,3519,3219,3375,3171,3600,3456,2978,3085,3793,3391,3441,2993,3388,3418,3597,3735,3056,3294,3369,3002,3473,3259,2963,3717,3192,3093,3548,3596,3474,3318,3440,3354,3102,3195,3133,3051,3644,3800,3530,3553,3808,3749,3279,3273,3246,3487,3722,3387,3771,3801,3739,3721,3349,2975,3790,3043,3170,3490,2997,3465,3146,3388,2966,3675,3827,3242,3655,3257,3437,3703],[3227,3443,3387,3634,3783,3075,3674,3881,3652,3754,3281,3896,3249,3370,3391,3563,3750,3880,3052,3458,3699,3788,3093,3211,3423,3759,3328,3066,3358,3784,3170,3901,3573,3162,3673,3538,3189,3911,3359,3145,3820,3711,3896,3519,3631,3067,3864,3682,3735,3095,3789,3345,3264,3121,3698,3894,3698,3778,3360,3172,3582,3514,3864,3283,3243,3846,3723,3708,3067,3701,3446,3845,3677,3374,3153,3193,3046,3379,3091,3343],[3711,3546,3219,3678,3870,3208,3790,3175,3160,3490,3295,3598,3291,3662,3364,3409,3607,3353,3978,3437,3393,3955,3358,3814,3617,3566,3312,3333,3960,3420,3879,3455,3658,3804,3942,3871,3550,3458,3845,3819,3182,3510,3892,3243,3318,3271,3738,3645,3713,3610,3573,3983,3858,3743,3412,3185,3954,3365,3431,3771,3301,3538,3942,3247,3972,3500,3791,3641,3165,3211,3232,3327,3770,3155,3363,3475,3777,3457,3867,3491],[3696,3554,3781,3604,3986,3881,3525,3414,3388,3429,3253,3821,3471,3755,3254,3920,3273,3750,3989,3359,3742,3728,3920,3244,4055,3655,3237,3859,3223,3548,3492,3766,4081,3453,3572,3593,4067,3408,3976,3767,3431,3869,3922,3956,4029,3645,3710,3311,3603,3760,3845,3876,3936,3981,3526,3467,3461,3832,3572,3870,3442,3431,3935,3780,3976,3411,3446,3469,3253,3285,3299,3939,3571,3358,3563,3716,3713,3667,3541,3341],[4062,3348,3380,3803,3878,3722,3397,3882,3760,3334,3955,3587,3410,3881,3562,3349,3869,3476,3465,3779,3832,3437,3434,4003,3918,3356,3466,3831,3394,3809,3388,3461,4114,4074,3510,3636,4013,3814,3556,4031,4096,3735,4066,3801,4034,4026,3330,3577,3753,3744,4098,3475,3791,4039,3806,3890,3649,3356,3554,3319,4139,3314,4050,4165,3678,3498,3339,4097,3871,3475,3538,3594,3707,3519,4116,4107,4079,3940,3515,3836],[4218,3736,3502,3425,3731,3882,4090,3479,3740,3726,3557,3654,3784,3449,3676,4233,4100,3792,3638,4082,3522,3599,4218,4243,3591,4169,4193,3522,3627,4219,3427,3473,4234,3710,3800,3834,4097,3529,3707,3569,3842,3811,4113,3532,3596,3904,4165,3764,3686,3638,3571,3808,3731,4030,3783,3960,4247,3442,4178,4000,4244,3597,4130,3474,4227,3746,3889,4026,4196,3610,3451,3602,3886,4031,3459,3696,3927,3686,4179,4007],[3510,4195,4261,3683,3784,4251,3711,3487,3796,3494,4088,4235,3650,3813,4028,3826,3550,3619,4037,3738,4230,3558,4322,3513,3804,4297,3882,4139,4134,4154,3701,4322,4255,3501,3707,3785,3814,3887,3682,4343,3615,3642,3957,4086,4238,4205,3939,3583,3936,3987,3955,3711,3777,3504,4050,4303,4096,3763,4250,3594,3600,4259,3981,4343,3874,4010,3773,3701,3780,3634,3621,3841,4181,3870,3539,4186,4336,3971,4045,4302],[3590,4310,4276,3950,4269,3702,4286,3668,3784,4259,4375,4303,4102,3667,3809,3842,3880,4188,3642,4355,3585,4135,4128,4243,4268,4367,3884,3939,3774,3897,3999,4124,3786,3852,3781,4407,4100,4079,3739,3694,4329,3818,4213,4133,3760,3842,4327,3620,3689,4000,4160,3567,4154,4176,4126,3822,4214,4244,4119,4311,3952,4055,3980,3896,3962,4211,4389,3760,3614,4159,3764,3639,3963,4133,4229,3900,4308,4316,3691,4306],[4227,4474,3787,3881,4285,3672,4387,3834,3893,4026,4023,3687,3988,3799,4390,4477,4469,4107,4216,4321,3923,3883,3703,4296,4191,4444,4157,3677,4111,4035,3660,3995,4338,4125,3847,4396,4424,4178,3752,3945,4356,4289,4335,4514,3752,4350,4042,4384,3961,3748,4029,3683,4053,3906,4122,4298,3872,4459,4292,3883,3860,4471,4129,4001,3686,3749,4327,4301,4435,3740,4510,3974,4236,4165,4377,3662,4407,3783,3933,4486],[3858,4020,3928,3845,4064,3901,4598,4087,3801,4137,4305,4013,3838,4190,3896,4210,3843,4344,3852,3859,3789,4301,3744,4077,4470,4024,3755,4072,3887,4087,4305,4432,4602,4587,4588,3877,4573,3911,4484,4414,4391,4387,4235,4151,3861,4021,4207,3934,4135,3757,4389,4028,4311,3765,4272,3903,3914,4191,4075,3986,3841,4590,4071,3754,4346,4336,4268,4391,4144,4309,4168,4264,4604,3888,4452,4533,4079,4176,3938,3828],[3963,4415,4424,4578,4036,4024,3875,4345,4633,4340,4046,3865,4162,3917,3977,4053,4095,3974,4311,4332,4514,4012,4449,4622,4447,3963,4059,4286,4336,4661,4346,4035,4684,3919,4036,4683,4181,4621,4397,4573,4093,4078,4332,3928,4552,4333,4332,3901,4318,4474,3848,4576,4647,4050,4009,4595,4636,4131,3892,4379,4308,3846,4637,3956,4390,4416,4120,3919,4345,3964,4161,4607,4633,4045,4609,4592,4424,4114,3881,3990],[3946,4034,3983,4425,4219,4665,4772,4061,4094,4397,4309,4230,4369,4184,4378,4200,4645,4106,4624,4168,4653,4413,4155,4364,4474,4115,4577,4284,4298,4183,4483,4655,4636,4257,4059,4327,4424,4722,4541,4063,4689,4677,4508,4251,4714,4709,4656,4711,4455,4048,4452,4575,4772,4329,4507,4595,4513,4587,4349,4035,4165,4153,4015,4027,4054,4294,4494,4494,4220,4170,4483,4723,3937,4770,4549,4342,3993,4171,4632,4047],[4872,4868,4077,4064,4263,4696,4410,4115,4439,4338,4360,4004,4687,4568,4320,4756,4383,4644,4442,4643,4171,4450,4726,4526,4068,4123,4318,4029,4154,4281,4075,4009,4827,4767,4319,4309,4453,4196,4209,4741,4022,4028,4295,4253,4007,4533,4125,4459,4617,4671,4598,4209,4449,4165,4409,4693,4637,4086,4582,4805,4705,4186,4253,4859,4519,4799,4300,4421,4112,4028,4727,4745,4339,4537,4029,4455,4187,4529,4043,4639],[4545,4550,4127,4570,4544,4173,4529,4296,4675,4422,4487,4361,4728,4801,4684,4866,4749,4689,4186,4094,4174,4723,4553,4818,4382,4940,4126,4862,4474,4469,4600,4328,4783,4880,4711,4228,4391,4600,4556,4200,4195,4257,4316,4449,4756,4182,4876,4312,4605,4925,4741,4635,4581,4868,4503,4368,4574,4726,4587,4703,4552,4839,4446,4536,4314,4541,4418,4228,4825,4846,4668,4420,4734,4804,4601,4144,4381,4124,4101,4894],[4282,4626,4389,4514,4846,4463,4857,4773,4495,4907,4603,4186,5042,4877,4250,4500,4600,4721,4371,4278,4553,4694,4234,4768,4633,4355,4876,4513,4488,4493,4392,4659,4415,4714,4309,4443,4635,4987,4449,4665,5045,4779,4771,4885,4958,5006,4805,4583,4308,4279,4268,4440,4468,4776,4263,4926,4674,4800,4388,4458,4423,4840,4748,4677,4432,4834,4809,4513,4692,4713,4405,4832,4957,4184,4953,4858,4980,4775,4813,4521],[4642,4860,4988,5039,4571,4646,4353,4284,4770,4772,4672,4441,4496,5023,4694,4897,4815,4804,4887,4607,4318,4402,4914,4907,4265,4989,4707,5103,4311,5114,4273,4638,4699,4948,4446,5000,4684,4351,4452,4334,4613,4445,5119,4465,4308,4326,4716,4389,4668,4320,5060,4648,4541,4655,4339,4734,4648,4756,4288,4788,4825,4487,4396,4963,4504,4397,4283,4460,4653,4290,4725,4831,4917,4307,4811,4669,4414,4541,4687,4552],[5217,4660,5078,4587,4579,4932,4658,4677,4974,5035,5206,4727,4617,4727,4940,4761,4799,4462,5165,4378,4966,5002,4771,4991,4551,4539,4415,4561,4454,5168,4401,4705,4997,4468,5043,5011,4964,4667,4470,4982,5007,4902,4476,5105,4819,4559,5054,4680,4523,4354,5207,5078,5192,4930,4924,4610,4944,4446,4649,4934,4691,4530,5212,5189,4741,4568,4799,4432,4619,5179,4744,4373,4665,5112,4612,4425,4441,4838,5008,4741],[5206,5104,5204,5061,5235,5046,4898,4761,4711,4757,5037,4854,5074,4931,4838,5301,4828,5276,4863,5215,4814,4668,4969,4859,5145,4915,5053,4566,4606,4712,5276,5172,4763,4590,5090,4780,4814,4461,5035,4754,4725,4750,4665,4549,4457,5299,4781,4880,4870,4832,4840,4594,4485,4744,4944,4770,4529,4466,4611,5050,5026,4521,4692,5006,4866,4594,5048,5286,4799,5044,4790,5100,5143,4529,5179,4579,5205,4618,4994,4598],[5185,5095,5233,4789,4908,4751,4975,4781,5108,5222,4767,4653,4597,4563,4777,5316,5126,5372,5171,5267,4615,4801,5346,4614,4560,4903,5250,4791,5328,4955,5360,5097,5381,4878,5150,5196,4884,5312,4600,5244,4615,5174,5340,5109,5381,5189,5156,4976,4597,5187,4885,5276,4532,4577,4647,4591,4675,4689,5365,4710,4704,5021,5090,5069,5324,4668,5045,5233,5118,5056,5181,5224,4954,4882,4727,4652,5179,4747,5326,4732],[4800,5323,4642,4665,5358,4907,5448,5460,5028,5255,5143,5180,4657,4996,5325,5385,5280,5320,4700,5480,4639,5135,4795,5381,5191,5088,5413,5396,4638,4841,5381,5253,4869,5155,4877,5226,4888,4868,4960,5433,5180,5368,4655,4851,5291,5178,5154,4699,5106,5470,5030,5278,4640,4968,5144,5456,5457,5320,5406,5030,5291,5373,4706,5151,4789,5262,5064,4766,5129,5054,4712,4727,5234,4710,5269,5330,5031,4968,4694,5063],[5019,5174,5235,4920,5556,5278,5434,4889,4931,4899,5328,5464,5023,5350,5538,4743,5296,5289,5360,5030,5374,5156,4900,5192,5554,4716,5122,4962,4925,5014,5463,5063,5300,4735,5189,5361,4805,5485,4717,5341,4807,5015,5261,5435,5503,5279,4759,5300,5281,5552,4964,5522,5467,5057,4994,4787,4879,5208,4711,5522,4924,5198,5426,4992,5306,5246,5380,5450,4940,5038,5112,5123,4822,4911,5257,5114,5137,4962,5528,4949],[5336,5307,5176,5361,5305,5647,4958,4939,4875,5231,5231,5294,5405,5449,4906,4914,5196,5333,4984,4862,5649,4944,4793,5044,5083,4867,5270,5187,5262,5543,5226,5300,5090,4838,4859,5398,5394,4899,5232,5379,5200,5001,4951,4937,5599,5430,4879,5009,5612,5331,5538,5114,5059,5078,4920,5164,4936,4888,5011,5084,5438,5043,5572,4814,5286,5025,5023,5618,5337,5571,5575,4952,5279,5354,5588,4944,5233,5641,5646,5207],[5585,5330,5550,5164,5219,5458,5505,5717,5351,5280,5355,5149,5278,5689,5430,5636,5192,5404,5315,5601,5437,5465,5212,5024,4921,5247,5071,4877,5697,5068,5160,5471,5388,5234,5683,4998,5294,5669,5534,5424,5139,5344,4922,5026,4979,4891,5733,5157,5120,5728,5699,5218,5529,5169,5322,5541,5349,5381,5353,5474,5608,5652,5614,5018,5357,5611,5294,5723,5451,4903,4962,5390,5152,5225,5208,5093,5263,4891,5422,5304],[5486,5015,5306,5530,5175,5169,5430,5061,5381,5707,5746,5568,5008,5444,4998,5705,5531,5713,5693,5794,5043,5422,5184,5398,5288,5825,5558,5385,5812,5615,5584,5714,5275,5207,5596,5660,5740,5721,5132,5520,5283,5373,5282,5214,5081,5210,5383,5734,5449,5821,5486,5554,5482,5115,5013,5236,5763,5215,5658,5797,5568,5774,5481,5534,5646,5694,5787,5537,5431,5489,5271,5819,5717,5447,5314,5611,5583,5232,5152,5345],[5307,5828,5406,5242,5682,5620,5519,5155,5148,5856,5494,5266,5792,5511,5402,5501,5420,5470,5480,5617,5659,5227,5218,5057,5372,5723,5777,5195,5430,5526,5683,5824,5424,5426,5509,5776,5454,5711,5887,5078,5375,5117,5760,5164,5301,5676,5075,5802,5451,5553,5385,5850,5135,5874,5093,5512,5151,5068,5285,5485,5057,5138,5457,5331,5835,5484,5821,5499,5117,5622,5728,5099,5048,5154,5735,5418,5172,5748,5134,5048],[5785,5295,5226,5450,5248,5293,5672,5873,5976,5680,5624,5640,5401,5891,5895,5912,5507,5550,5641,5424,5262,5542,5141,5881,5208,5726,5533,5633,5360,5807,5826,5740,5635,5747,5999,5547,5599,5918,5404,5612,5568,5748,5524,5907,5602,5236,5534,5328,5224,5906,5375,5943,5544,5551,5385,5187,5493,5599,5608,5918,5496,5617,6000,5517,5607,5916,5245,5851,5445,5188,5163,5677,6000,5142,5189,5291,5709,5979,5443,5761],[5635,6057,5860,5546,5983,5422,5255,5691,5603,6015,5468,6051,5552,5953,5266,6004,5725,5800,5660,5768,5504,5391,6080,5371,5540,5587,6078,6061,5702,5829,5534,5484,5375,5878,5405,5360,5397,5679,5785,5783,5761,5349,5762,5933,5466,5568,6059,5499,5328,5352,5277,5543,5457,5854,5327,5766,5958,5386,5846,5666,5847,5929,5292,5384,5486,5413,5535,5939,5783,5808,5688,5568,5958,5659,5824,5487,5417,5396,5538,5673]]",
    3, 74560)]
  public void Test(string grid, int k, int expected)
  {
    new Solution().MinCost(grid.Array2(), k).Should().Be(expected);
  }
}
